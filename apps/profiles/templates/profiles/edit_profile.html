{% extends '_base.html' %}

{% load widget_tweaks %}

{% block head_title %}
    Edit Profile
{% endblock head_title %}

{% block content %}
<div class="container mx-auto p-4 mt-76 pb-76" style="max-width: 600px;">
    <a href="{% url 'profiles:profile' user.username %}" class="btn btn-outline-light rounded-3 mb-4 fw-bold">
        <i class="bi bi-chevron-left me-1"></i> Back
    </a>
    <div class="d-flex align-items-center justify-content-between mb-4">
        <h1 class="h4 fw-bold">Edit profile</h1>
        <form method="POST" action="{% url 'accounts:logout' %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger p-2 rounded-3 fw-bold">Log out</button>
        </form>
    </div>
    <div class="card border-0 d-flex flex-column flex-sm-row align-items-center justify-content-between mb-4 gap-3 p-2 px-3 rounded-3">
        <div class="d-flex align-items-center flex-grow-1">
            <img src="{{ profile.image_or_default }}" class="rounded-circle me-3 me-sm-4 profile-img-md mint-gradient-ring" alt="Profile">
            <span class="fw-bold text-truncate">{{ profile.user.username }}</span>
        </div>
        <div class="w-100 w-sm-auto text-center text-sm-end">
            <form method="POST" action="{% url 'profiles:update_profile_image' %}" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="file" name="image" class="d-none" id="imageInput" accept="image/*" onchange="this.form.submit();">
                <button type="button" class="btn btn-sm btn-primary fw-bold rounded-3 px-3 px-sm-4"
                    onclick="document.getElementById('imageInput').click();"
                >
                    Change photo
                </button>
            </form>
        </div>
    </div>
    <hr class="mb-4">
    <div class="mb-4">
        <h2 class="h6 fw-bold mb-3">Website</h2>
        <div class="card border-0 rounded-3">
            <div class="card-body">
                <form method="POST" action="{% url 'profiles:update_profile_url' %}">
                    {% csrf_token %}
                    {% render_field url_form.url class="form-control mb-1 rounded-3" %}
                    <button type="submit" class="btn btn-primary fw-bold btn-sm rounded-3 mt-2 px-4">Update</button>
                </form>
            </div>
        </div>
    </div>
    <hr class="mb-4">
    <div class="mb-4">
        <h2 class="h6 fw-bold mb-3">Bio</h2>
        <div class="card border-0 rounded-3">
            <div class="card-body">
                <form method="POST" action="{% url 'profiles:update_profile_bio' %}">
                    {% csrf_token %}
                    {% render_field bio_form.bio class="form-control mb-1 rounded-3" rows=3 %}
                    <input type="hidden" name="bio_form">
                    <button type="submit" class="btn btn-primary fw-bold btn-sm rounded-3 mt-2 px-4">Update</button>
                </form>                
            </div>
        </div>
    </div>
</div>
{% include 'feed/includes/mobile_nav.html' %}
{% endblock content %}