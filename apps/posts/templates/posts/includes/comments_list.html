{% for comment in comments_page %}
    {% include 'posts/partials/comment.html' with node=comment %}
{% endfor %}

{% if comments_page.has_next %}
    <!-- This element will replace itself with new content -->
    <div class="comments-loading-trigger"
        hx-get="{% url 'posts:post_preview' post.pk %}?page={{ comments_page.next_page_number }}"
        hx-trigger="intersect once delay:300ms"
        hx-target="this"
        hx-swap="outerHTML"
        hx-indicator="#comments-spinner-{{ comments_page.number }}">
        
        <!-- Loading spinner -->
        <div id="comments-spinner-{{ comments_page.number }}" class="d-flex justify-content-center py-3">
            <div class="spinner-border text-light" role="status">
                <span class="visually-hidden">Loading more commentsâ€¦</span>
            </div>
        </div>
    </div>
{% endif %}