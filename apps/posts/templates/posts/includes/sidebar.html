{% load widget_tweaks %}

<div class="col-lg-4 desktop-only">
    <div class="sticky-top" style="top: 76px; padding-left: 24px;">
        <div class="d-flex align-items-center mb-4">
            <img src="{{ user.profile.image_or_default }}" class="profile-img me-3" style="width: 56px; height: 56px;" alt="Profile">
            <div>
                <a href="{% url 'profiles:profile' user.username %}" class="text-decoration-none fw-bold text-white">{{ user.username }}</a>
                <p class="text-muted small mb-0">{{ user.full_name }}</p>
            </div>
        </div>
        <div class="mb-3">
            <div class="d-flex justify-content-between align-items-center">
                <span class="text-muted fw-bold">Filter Posts</span>
                <button class="btn btn-sm btn-dark"
                    type="button"
                    data-bs-toggle="collapse" 
                    data-bs-target="#filterCollapse"
                    aria-expanded="false" 
                    aria-controls="filterCollapse"
                >
                    <span class="small fw-bold text-muted">Open Filters</span>
                </button>
            </div>
            <div class="collapse" id="filterCollapse">
                <form id="filterForm" method="GET"
                    hx-get="{% url 'posts:feed' %}"
                    hx-target="#feed-container"
                    hx-swap="innerHTML"
                >
                    <div class="d-flex align-items-center justify-content-between mb-2 gap-2">
                        <div class="w-50">
                            <span class="small fw-semibold text-muted">{{ filter.form.start_date.label }}</span>
                            {% render_field filter.form.start_date class="form-control rounded-3 border-0" %}
                        </div>
                        <div class="w-50">
                            <span class="small fw-semibold text-muted">{{ filter.form.end_date.label }}</span>
                            {% render_field filter.form.end_date class="form-control rounded-3 border-0" %}
                        </div>
                    </div>
                    <button class="btn btn-sm btn-dark w-100 rounded-3" type="submit">
                        <i class="bi bi-funnel small me-1"></i> <span class="fw-bold">Filter</span>
                    </button>
                </form>
            </div>
        </div>
        <div class="suggestions-title d-flex justify-content-between align-items-center mb-3">
            <h6 class="text-muted fw-bold">Suggestions For You</h6>
            <a href="#" class="text-white text-decoration-none fw-bold small">See All</a>
        </div>
        {% for follow in request.user.following.all %}
            <div class="d-flex align-items-center justify-content-between mb-3">
                <div class="d-flex align-items-center">
                    <img src="{{ follow.user.profile.image_or_default }}" class="suggestion-avatar me-2" alt="User avatar">
                    <div class="d-flex flex-column">
                        <a href="#" class="fw-bold small text-white text-decoration-none">{{ follow.user.username }}</a>
                        <span class="suggestion-detail">Followed by janesmith + 12 more</span>
                    </div>
                </div>
                <button class="suggestion-follow btn bg-transparent border-0 fw-bold text-primary cursor-pointer p-0">Follow</button>
            </div>
        {% endfor %}
        <div class="footer-links">
            <a href="{% url 'about' %}">About</a>
            <a href="">Help</a>
            <a href="">API</a>
            <a href="">Privacy</a>
            <a href="">Terms</a>
        </div>
        <div class="copyright">
            Â© 2025 Lumen
        </div>
    </div>
</div>